id: com.atomix.Alkaline
runtime: org.gnome.Platform
runtime-version: '47'
sdk: org.gnome.Sdk
command: alkaline
finish-args:
  - --share=network
  - --filesystem=home
  - --talk-name=org.freedesktop.Notifications

modules:
  - name: alkaline
    buildsystem: simple
    build-commands:
      # Create necessary directories
      - install -d /app/bin
      - install -d /app/lib/python3.12/site-packages/
      - install -d /app/share/icons/hicolor/48x48/apps
      - install -d /app/share/applications
      # Install the main executable script with the correct name and permissions
      - install -m 755 src/alkaline_app.py /app/bin/alkaline
      # Install all Python modules from src/ directory
      - install src/*.py /app/lib/python3.12/site-packages/
      # Install Python dependencies using pip
      - python3 -m pip install --upgrade pip
      - python3 -m pip install -r requirements.txt --target=/app/lib/python3.12/site-packages/
      # Install the application icon
      - install -m 644 assets/icons/alkaline.png /app/share/icons/hicolor/48x48/apps/com.atomix.Alkaline.png
      # Install the desktop entry file
      - install -m 644 data/com.atomix.Alkaline.desktop /app/share/applications/com.atomix.Alkaline.desktop
    build-options:
      env:
        PYTHONPATH: /app/lib/python3.12/site-packages
    sources:
      - type: dir
        path: .
